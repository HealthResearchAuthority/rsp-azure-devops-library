steps:
  - task: NuGetAuthenticate@1
    displayName: 'NuGet Authenticate'

  - script: |
      echo "Pushing .nupkg packages (excluding symbols)..."
      find "$(Build.ArtifactStagingDirectory)" -name '*.nupkg' ! -name '*.symbols.nupkg' | while read pkg; do
        echo "Pushing $pkg"
        dotnet nuget push "$pkg" --source "vsts_feed" --skip-duplicate --api-key AzureDevOps
      done
    displayName: 'Push NuGet packages'