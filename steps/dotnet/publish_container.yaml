steps:
  - task: DotNetCoreCLI@2
    displayName: 'Publish container'
    inputs:
      command: "publish"
      publishWebProjects: false
      projects: '**/**/Rsp.IrasService.csproj'
      arguments: '-t:PublishContainer -p ContainerImageTags=$(buildid)' # -p:ContainerRepository=rsp-irasservice -p:ContainerRegistry=crrspacaypvupdevuks.azurecr.io'
      #arguments: '-t:PublishContainer -p ContainerImageTags=$(buildid) -p:ContainerRegistry=crrspacaypvupdevuks.azurecr.io -p:ContainerImageName=irasService -p:ContainerRepository=irasServiceRepository'
  # - task: Docker@2
  #   displayName: 'Tag and Push'
  #   inputs:
  #     command: "push"
  #     containerRegistry: $(acrDevConnection)
  #     tags: rsp-irasservice:$(buildid)
  #     repository: rsp-irasservice
  - task: AzureCLI@2
    displayName: Build and Push to DEV ACR
    inputs:
      azureSubscription: $(azureServiceConnection)
      scriptType: pscore
      scriptLocation: inlineScript
      inlineScript: |
        az acr login --name crrspacaypvupdevuks.azurecr.io
        docker tag rsp-irasservice:$(buildid) crrspacaypvupdevuks.azurecr.io/rsp-irasservice:$(buildid)
        docker push crrspacaypvupdevuks.azurecr.io/rsp-irasservice:$(buildid)
